{%- macro ipaddr(net="") %}
{%- set host_num = ansible_default_ipv4.address | ipaddr("int") - ansible_default_ipv4.network | ipaddr("int") %}
{{- net | ipaddr(host_num) }}
{%- endmacro %}
network:
    version: 2
    vlans:
{% for iface in ['ceph', 'k8s'] %}
       {{lookup('vars', iface+'_iface')}} :
            addresses:
            - {{ipaddr(lookup('vars', iface+'_net'))}}
            id: {{lookup('vars', iface+'_vlan')}}
            link: bond0
            mtu: 1500
{% endfor %}
