{%- macro ipaddr(net="") %}
{%- set host_num = ansible_default_ipv4.address | ipaddr("int") - ansible_default_ipv4.network | ipaddr("int") %}
{{- net | ipaddr(host_num) | ipaddr('address') }}
{%- endmacro %}
{% for iface in ['ceph', 'k8s'] %}
auto {{lookup('vars', iface+'_iface')}}
iface {{lookup('vars', iface+'_iface')}} inet static
address {{ipaddr(lookup('vars', iface+'_net'))}}
netmask {{lookup('vars', iface+'_net') | ipaddr('netmask')}}
{% endfor %}
